!function(e){"use strict";var t=function(){var f="xls",l={xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",csv:"application/csv"},e=function(){return this.jsonToExcel=function(e,t){var o="",n=[];return o+="<thead>",t.forEach(function(e){o+="<th>"+e.title+"</th>",e.computed&&"function"==typeof e.computed?n.push(e.computed):e.dataIndex&&"string"==typeof e.dataIndex?n.push(e.dataIndex):n.push(null)}),o+="</thead>",o+="<tbody>",e.forEach(function(t){o+="<tr>",n.forEach(function(e){o+="<td>",o+="string"==typeof e?t[e]:"function"==typeof e&&e(t)||"",o+="</td>"}),o+="</tr>"}),'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Sheet1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>${table}</table></body></html>'.replace("${table}",o+="</tbody>")},this.jsonToCSV=function(e,t){var o="",n=[],r=[];return t.forEach(function(e){n.push(e.title),e.computed&&"function"==typeof e.computed?r.push(e.computed):e.dataIndex&&"string"==typeof e.dataIndex?r.push(e.dataIndex):r.push(null)}),e.forEach(function(t){r.forEach(function(e){o+="string"==typeof e?t[e]:"function"==typeof e&&e(t)||"",o+=","}),o=o.slice(0,o.length-1),o+="\r\n"}),n.join(",")+"\r\n"+o},this}.call({}),u={xls:e.jsonToExcel,xlsx:e.jsonToExcel,csv:e.jsonToCSV};function d(e){for(var t=e.split(","),o=t[0].match(/:(.*?);/)[1],n=atob(t[1]),r=n.length,c=new Uint8Array(r);r--;)c[r]=n.charCodeAt(r);return new Blob([c],{type:o})}return{exportFile:function(e,t,o){var n,r=(i=t||"test",a={name:i,suffix:f},s=new RegExp("(.+)\\.(\\w+)$","i").exec(i),s&&s&&(a.name=s[1],a.suffix=s[2]),a),c=l[r.suffix];var i,a,s;c?function(e,t){if(window.navigator.msSaveBlob){var o=d(e);return window.navigator.msSaveBlob(o,t)}var n=document.createElement("a"),r=e;if(window.URL.createObjectURL){var o=d(e);r=window.URL.createObjectURL(o)}n.href=r,n.download=t,document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n)},1)}("data:"+c+";base64,"+(n=u[r.suffix](e,function(e,t){if(t&&0<t.length)return t;var o=[];if(e&&e.length){var n=e[0];for(var r in n)n.hasOwnProperty(r)&&o.push({title:r,dataIndex:r})}return o}(e,o)),window.btoa(window.unescape(encodeURIComponent(n)))),r.name+"."+r.suffix):console.log("Export of the current file type is not supported!")}}}();"function"==typeof define&&define.amd?define(function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.JSONEXPORT=t):e.JSONEXPORT=t}(this);